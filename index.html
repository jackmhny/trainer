<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Poker Range Trainer (Correct 6-Max Order)</title>
  <style>
    /* ===== General Page Styles ===== */
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    h1, h2 {
      text-align: center;
    }
    p {
      text-align: center;
    }
    .button {
      margin: 5px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }

    /* ===== Tab Navigation ===== */
    #tabs {
      text-align: center;
      margin-bottom: 20px;
    }
    .tab {
      display: inline-block;
      padding: 10px 20px;
      background-color: #eee;
      margin-right: 10px;
      cursor: pointer;
      border-radius: 5px;
    }
    .tab.active {
      background-color: #ddd;
      font-weight: bold;
    }
    .tab-content {
      display: none; /* Hidden by default */
    }
    .tab-content.active {
      display: block; /* Shown when active */
    }

    /* ===== Range Editor (Grid) Styles ===== */
    .grid-container {
      margin: 0 auto 20px auto;
      border: 2px solid #000;
      overflow-x: auto;
      max-width: 90%;
    }
    table {
      border-collapse: collapse;
      margin: 0 auto;
      min-width: 600px; /* Ensures table is wide enough */
    }
    th, td {
      border: 1px solid #ccc;
      padding: 5px;
      text-align: center;
      width: 40px;
      height: 40px;
    }
    th {
      background-color: #eee;
    }
    /* Color states for fold/call/raise */
    .state-fold {
      background-color: white;
    }
    .state-call {
      background-color: #FFFF99; /* Light yellow */
    }
    .state-raise {
      background-color: #99FF99; /* Light green */
    }

    /* ===== Play Mode Styles ===== */
    .hand-display {
      font-size: 24px;
      margin: 20px 0;
      text-align: center;
    }
    #feedback, #scoreDisplay {
      text-align: center;
      font-size: 18px;
      margin-top: 10px;
    }

    /* ===== Poker Table Graphic (Correct 6-max order, clockwise) ===== */
    .poker-table {
      position: relative;
      width: 400px;
      height: 400px;
      margin: 0 auto 20px auto;
      border: 2px solid #006400;
      border-radius: 50%;
      background-color: #0a5;
    }
    .player {
      position: absolute;
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background-color: #fff;
      border: 2px solid #000;
      text-align: center;
      line-height: 80px;
      font-size: 14px;
      overflow: hidden; /* so "cards" can fit inside neatly if needed */
    }
    .name {
      margin-top: 5px;
      font-weight: bold;
      line-height: normal;
    }
    .cards {
      margin-top: -10px;
    }
    .card {
      display: inline-block;
      width: 24px;
      height: 32px;
      border: 1px solid #000;
      border-radius: 3px;
      margin: 0 1px;
      text-align: center;
      line-height: 32px;
      font-size: 14px;
      background-color: white;
      color: #000;
    }
    .card.face-down {
      background-color: #666;
      color: #666; /* hides the rank visually */
    }
    .folded {
      font-size: 12px;
      color: #444;
    }

    /*
      6-Max order (clockwise):
      SB (bottom-left) → BB (bottom-right) → LJ (middle-right) → HJ (top-right) → CO (top-left) → BTN (bottom-center)
    */
    .player.sb {
      bottom: 40px;
      left: 10%;
    }
    .player.bb {
      bottom: 40px;
      right: 10%;
    }
    .player.lj {
      top: 50%;
      right: 5%;
      transform: translateY(-50%);
    }
    .player.hj {
      top: 20px;
      right: 25%;
    }
    .player.co {
      top: 20px;
      left: 25%;
    }
    .player.btn {
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
    }
  </style>
</head>
<body>
  <h1>Poker Range Trainer (BTN RFI Scenario)</h1>

  <!-- Tab Navigation -->
  <div id="tabs">
    <div class="tab active" data-tab="rangeEditor">Range Editor (Button Opening Range)</div>
    <div class="tab" data-tab="play">Play</div>
  </div>

  <!-- Range Editor Tab -->
  <div id="rangeEditor" class="tab-content active">
    <h2>Range Editor (Click & Drag)</h2>
    <p>Select an action, then click and drag across the grid to set multiple cells at once!</p>
    <div style="text-align: center; margin-bottom: 10px;">
      <label for="actionSelect">Current Action:</label>
      <select id="actionSelect">
        <option value="fold">Fold</option>
        <option value="call">Call</option>
        <option value="raise">Raise</option>
      </select>
    </div>

    <div class="grid-container">
      <table id="rangeGrid">
        <!-- The 13×13 grid will be generated by JavaScript -->
      </table>
    </div>
    <p>Then switch to the Play tab to practice!</p>
  </div>

  <!-- Play Tab -->
  <div id="play" class="tab-content">
    <h2>Play Mode</h2>
    <p><strong>Scenario:</strong> It's folded around to you on the Button. LJ, HJ, and CO have folded. SB and BB are still in with face-down cards.</p>
    <p>Your position: <strong>BTN</strong></p>

    <!-- Poker Table Layout -->
    <div class="poker-table">
      <!-- SB (face-down) -->
      <div class="player sb">
        <div class="name">SB</div>
        <div class="cards">
          <div class="card face-down"></div>
          <div class="card face-down"></div>
        </div>
      </div>
      <!-- BB (face-down) -->
      <div class="player bb">
        <div class="name">BB</div>
        <div class="cards">
          <div class="card face-down"></div>
          <div class="card face-down"></div>
        </div>
      </div>
      <!-- LJ folded -->
      <div class="player lj">
        <div class="name">LJ</div>
        <div class="cards folded">Folded</div>
      </div>
      <!-- HJ folded -->
      <div class="player hj">
        <div class="name">HJ</div>
        <div class="cards folded">Folded</div>
      </div>
      <!-- CO folded -->
      <div class="player co">
        <div class="name">CO</div>
        <div class="cards folded">Folded</div>
      </div>
      <!-- BTN (You) face-up -->
      <div class="player btn">
        <div class="name">BTN (You)</div>
        <div class="cards">
          <div class="card" id="btnCard1"></div>
          <div class="card" id="btnCard2"></div>
        </div>
      </div>
    </div>

    <!-- Standard quiz UI below -->
    <div class="hand-display" id="handDisplay">Click "Next Hand" to get your cards!</div>
    <div style="text-align: center;">
      <button id="foldButton" class="button">Fold</button>
      <button id="callButton" class="button">Call</button>
      <button id="raiseButton" class="button">Raise</button>
    </div>
    <div id="feedback"></div>
    <div style="text-align: center;">
      <button id="nextHand" class="button">Next Hand</button>
      <button id="resetScore" class="button">Reset Score</button>
    </div>
    <div id="scoreDisplay">Score: 0</div>
  </div>

  <!-- JavaScript at the bottom -->
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      console.log("DOM loaded. Initializing...");

      // ===== TAB SWITCHING =====
      var tabs = document.querySelectorAll('.tab');
      var tabContents = document.querySelectorAll('.tab-content');
      for (var i = 0; i < tabs.length; i++) {
        tabs[i].addEventListener("click", function() {
          for (var j = 0; j < tabs.length; j++) {
            tabs[j].classList.remove("active");
          }
          for (var k = 0; k < tabContents.length; k++) {
            tabContents[k].classList.remove("active");
          }
          this.classList.add("active");
          var tabId = this.getAttribute("data-tab");
          document.getElementById(tabId).classList.add("active");
        });
      }

      // ===== RANGE EDITOR (CLICK & DRAG) =====
      var ranks = ["A", "K", "Q", "J", "T", "9", "8", "7", "6", "5", "4", "3", "2"];
      var suits = ["♠", "♥", "♦", "♣"];
      var rangeMapping = {}; // e.g. "AKs" -> "fold"/"call"/"raise"
      var currentAction = "fold"; // default
      var isDrawing = false;      // are we holding mouse down?

      var actionSelect = document.getElementById("actionSelect");
      actionSelect.addEventListener("change", function() {
        currentAction = this.value;
      });

      function initRangeMapping() {
        for (var r1 = 0; r1 < ranks.length; r1++) {
          for (var r2 = 0; r2 < ranks.length; r2++) {
            var notation;
            if (r1 === r2) {
              notation = ranks[r1] + ranks[r2]; // pair
            } else if (r1 < r2) {
              notation = ranks[r1] + ranks[r2] + "s"; // suited
            } else {
              notation = ranks[r2] + ranks[r1] + "o"; // offsuit
            }
            rangeMapping[notation] = "fold";
          }
        }
      }

      function generateGrid() {
        var table = document.getElementById("rangeGrid");
        table.innerHTML = "";

        // Header row
        var headerRow = document.createElement("tr");
        var emptyHeader = document.createElement("th");
        headerRow.appendChild(emptyHeader);
        for (var col = 0; col < ranks.length; col++) {
          var th = document.createElement("th");
          th.innerText = ranks[col];
          headerRow.appendChild(th);
        }
        table.appendChild(headerRow);

        // Rows
        for (var rowIndex = 0; rowIndex < ranks.length; rowIndex++) {
          var row = document.createElement("tr");
          var rowHeader = document.createElement("th");
          rowHeader.innerText = ranks[rowIndex];
          row.appendChild(rowHeader);

          for (var colIndex = 0; colIndex < ranks.length; colIndex++) {
            var cell = document.createElement("td");
            var notation;
            if (rowIndex === colIndex) {
              notation = ranks[rowIndex] + ranks[colIndex]; // pair
            } else if (rowIndex < colIndex) {
              notation = ranks[rowIndex] + ranks[colIndex] + "s"; // suited
            } else {
              notation = ranks[colIndex] + ranks[rowIndex] + "o"; // offsuit
            }
            cell.innerText = notation;
            cell.dataset.notation = notation; // store the notation in a data-attribute
            cell.classList.add("state-fold"); // default

            // Single click or drag events
            cell.addEventListener("mousedown", function(e) {
              isDrawing = true;
              setCellAction(e.target);
            });
            // "mouseover" triggers if we move onto this cell while mouse is down
            cell.addEventListener("mouseover", function(e) {
              if (isDrawing) {
                setCellAction(e.target);
              }
            });

            row.appendChild(cell);
          }
          table.appendChild(row);
        }

        // If user releases mouse outside table, end "drawing" mode
        document.addEventListener("mouseup", function() {
          isDrawing = false;
        });
      }

      function setCellAction(cellElement) {
        var notation = cellElement.dataset.notation;
        rangeMapping[notation] = currentAction;
        cellElement.classList.remove("state-fold", "state-call", "state-raise");
        cellElement.classList.add("state-" + currentAction);
      }

      // ===== PLAY MODE (BTN RFI) =====
      var currentHand = null;
      var score = 0;

      function getRandomCard() {
        var rank = ranks[Math.floor(Math.random() * ranks.length)];
        var suit = suits[Math.floor(Math.random() * suits.length)];
        return { rank: rank, suit: suit };
      }

      function generateHand() {
        var card1 = getRandomCard();
        var card2 = getRandomCard();
        while (card1.rank === card2.rank && card1.suit === card2.suit) {
          card2 = getRandomCard();
        }
        return [card1, card2];
      }

      // Show the user’s two BTN cards on the seat and in text
      function displayHand(hand) {
        var c1 = hand[0].rank + hand[0].suit;
        var c2 = hand[1].rank + hand[1].suit;
        document.getElementById("btnCard1").innerText = c1;
        document.getElementById("btnCard2").innerText = c2;
        document.getElementById("handDisplay").innerText = "Your hand: " + c1 + " " + c2;
      }

      function handToNotation(hand) {
        var card1 = hand[0];
        var card2 = hand[1];
        // ensure consistent ordering
        if (ranks.indexOf(card1.rank) > ranks.indexOf(card2.rank)) {
          var temp = card1;
          card1 = card2;
          card2 = temp;
        }
        if (card1.rank === card2.rank) {
          return card1.rank + card2.rank; // pair
        } else {
          var suited = (card1.suit === card2.suit) ? "s" : "o";
          return card1.rank + card2.rank + suited;
        }
      }

      function handleAnswer(selectedAction) {
        if (!currentHand) {
          alert("Please generate a hand first!");
          return;
        }
        var notation = handToNotation(currentHand);
        var correctAction = rangeMapping[notation] || "fold";
        if (selectedAction === correctAction) {
          document.getElementById("feedback").innerText =
            "Correct! (" + notation + " -> " + correctAction + ")";
          score++;
        } else {
          document.getElementById("feedback").innerText =
            "Incorrect. (" + notation + " -> " + correctAction + ")";
          score--;
        }
        document.getElementById("scoreDisplay").innerText = "Score: " + score;
      }

      // ===== INITIALIZE =====
      initRangeMapping();
      generateGrid();

      // Hook up Play buttons
      document.getElementById("nextHand").addEventListener("click", function() {
        currentHand = generateHand();
        displayHand(currentHand);
        document.getElementById("feedback").innerText = "";
      });
      document.getElementById("resetScore").addEventListener("click", function() {
        score = 0;
        document.getElementById("scoreDisplay").innerText = "Score: 0";
      });
      document.getElementById("foldButton").addEventListener("click", function() {
        handleAnswer("fold");
      });
      document.getElementById("callButton").addEventListener("click", function() {
        handleAnswer("call");
      });
      document.getElementById("raiseButton").addEventListener("click", function() {
        handleAnswer("raise");
      });

      console.log("Initialization complete. Seats now go SB -> BB -> LJ -> HJ -> CO -> BTN in clockwise order.");
    });
  </script>
</body>
</html>
